<!DOCTYPE html>
<html>
<head>
    <style>
        .texte-titre{
            padding: 3px;
            text-align: center;
            font-size: 10pt;
            font-weight: bold;
        }
        .texte-normal{
            padding: 3px;
            font-size: 9pt;
        }
        .texte-gras{
            font-weight: bold;
        }
        .texte-petit{
            padding: 3px;
            font-size: 8pt;
        }
        .texte-centre{
            text-align: center;
        }
        .texte-gauche{
            text-align: left;
        }
        .texte-droite{
            text-align: right;
        }
        .bordure{
            border: 0.5px solid black;
        }
        .bordure-top{
            border-top: 0.5px solid black;
        }
        .bordure-bottom{
            border-bottom: 0.5px solid black;
        }
        .bg-sombre{
            background-color: lightgray;
        }
        .bg-pair{
            background-color: whitesmoke;
        }
        .largeur-max{
            width: 100%;
        }
        .centre{
            margin-left: auto;
            margin-right: auto;
        }
        .droite{
            margin-left: auto;
            margin-right: 0%;
        }
        .titre-document{
            border-top: 2px solid black;
            border-bottom: 2px solid black;
            background-color: lightgray;
            font-size: 10pt;
            font-weight: bold;
            margin-top: 20px;
            text-align: center;
            padding: 3px;
            width: 100%;
        }
        .largeur-logo{
            width: 30%;
        }
        .image-centre{
            margin-left: 30%;
            margin-right: 30%;
            width: 40%;
        }
        .marge-top-extralarge{
            margin-top: 100px;
        }
        .marge-bottom-zero{
            bottom: 0px;
        }
        .marge-top-large{
            margin-top: 50px;
        }
        .marge-top-moyen{
            margin-top: 20px;
        }
        .tableau-contenu-entete{
            border: 0.5px solid black;
            border-spacing: 0px;
            background-color: lightgray;
            padding: 3px;
            text-align: center;
        }
        .tableau-contenu-normal{
            border: 0.5px solid black;
            padding: 3px;
        }
        .tableau-contenu-droite{
            text-align: right;
        }
        .tableau-bordure{
            border: 0.5px solid black;
            border-spacing: 0px;
            padding: 3px;
        }
        .tableau-bordure-blanche{
            border: 1px solid white;
            border-spacing: 0px;
            padding: 3px;
        }
        .tableau-bordure-bottom{
            border-bottom: 0.5px solid black;
            border-spacing: 0px;
            padding: 3px;
        }
        .tableau-bordure-top{
            border-top: 0.5px solid black;
            border-spacing: 0px;
            padding: 3px;
        }
        .tableau-bordure-zero{
            border: 0px solid black;
            border-spacing: 0px;
            padding: 3px;
        }
        .page{
            page-break-after: always;
        }
        .page:last-child{
            page-break-after: unset;
        }
    </style>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title>Facture - {{facture.id}}</title>
</head>
<body>
    <div class="page texte-normal">
        {# Entête de la page #}
        <div class="header">
            {# barre du logo #}
            <table class="tableau-bordure-zero centre">
                <tr>
                    <td>
                        <img src="{{imageSrc}}" class="image-centre"> 
                    </td>
                </tr>
                <tr>
                    <td class="texte-centre">
                        <span class="texte-titre">{{facture.entreprise.nom}}</span><br>
                        <span class="texte-normal">{{facture.entreprise.adresse}}<span>
                    </td>
                </tr>
            </table>
            {# barre de titre #}
            <div class="titre-document">FACTURE N°{{facture.reference}}</div>
        </div>
        {# Contenu de la page #}
        <div class="corps">
            {# Référence, date et type de facture #}
            <table class="tableau-bordure-zero centre texte-normal" style="width: 98%;">
                <tr class="bg-pair">
                    <td>RCCM: <strong>{{facture.entreprise.rccm}}</strong></td>
                    <td class="texte-droite">DATE: <strong>{{facture.createdAt | date("d/m/Y à G:H:i")}}</strong></td>
                </tr>
                <tr>
                    <td>NIF: <strong>{{facture.entreprise.numimpot}}</strong></td>
                    <td class="texte-droite">REFERENCE: <strong>{{facture.reference}}</strong></td>
                </tr>
                <tr class="bg-pair">
                    <td>ID. NAT: <strong>{{facture.entreprise.idnat}}</strong></td>
                    <td class="texte-droite">NATURE: <strong>{{nature}}</strong></td>
                </tr>
            </table>

            {# Facture à l'attention de... & Description de la facture #}
            <table class="tableau-bordure-zero centre marge-top-large" style="width: 98%;">
                <tr>
                    <td>
                        Pour:</br>
                        {{pour|raw}}
                    </td>
                    <td class="texte-droite">
                        Description: </br>
                        <strong>
                            {{facture.description|raw}}
                        </strong>
                    </td>
                </tr>
            </table>

            {% set montant_ht = facture.totalDu / 100 / 1.16 %}
            {% set montant_taxe = (montant_ht * 16) / 100 %}
            {% set montant_ttc = montant_ht + montant_taxe %}

            {# Synthèse des totaux #}
            <table class="tableau-bordure-zero centre marge-top-extralarge">
                <tr>
                    <td class="texte-centre" colspan="2">Synthèse</td>
                </tr>
                <tr>
                    <td class="tableau-bordure-blanche texte-titre bg-sombre"><strong>RUBRIQUES</strong></td>
                    <td class="tableau-bordure-blanche texte-titre bg-sombre"><strong>MONTANTS</strong></td>
                </tr>
                <tr class="bg-pair">
                    <td class="tableau-bordure-blanche texte-normal">Montant dû (ht)</td>
                    <td class="tableau-bordure-blanche texte-normal texte-droite">{{montant_ht|format_currency(monnaie, {fraction_digit: 2})}}</td>
                </tr>
                <tr>
                    <td class="tableau-bordure-blanche texte-normal">Taxes (tva @16%)</td>
                    <td class="tableau-bordure-blanche texte-normal texte-droite">{{montant_taxe|format_currency(monnaie, {fraction_digit: 2})}}</td>
                </tr>
                <tr class="bg-sombre">
                    <td class="tableau-bordure-blanche texte-normal texte-gras">Total à payer</td>
                    <td class="tableau-bordure-blanche texte-normal texte-droite texte-gras">{{montant_ttc|format_currency(monnaie, {fraction_digit: 2})}}</td>
                </tr>
            </table>

            {# Signatiare de la facture #}
            <table class="tableau-bordure-zero droite marge-top-extralarge">
                <tr>
                    <td class="texte-centre">
                        <span class="texte-titre">{{facture.signedBy}}</span></br>
                        <span class="texte-normal">{{facture.posteSignedBy}}</span>
                    </td>
                </tr>
            </table>
        </div>

        <div class="footer texte-petit marge-top-large">
            {# Les Comptes bancaires et leurs numéros #}
            <table class="tableau-bordure-zero largeur-max">
                <tr>
                    <td colspan="5">Références bancaires</td>
                </tr>
                <tr class="texte-gras texte-centre bg-sombre">
                    <td class = "tableau-bordure-blanche">Intitulé</td>
                    <td class = "tableau-bordure-blanche">Numéro</td>
                    <td class = "tableau-bordure-blanche">Banque</td>
                    <td class = "tableau-bordure-blanche">Code Swift</td>
                    <td class = "tableau-bordure-blanche">Devise</td>
                </tr>
                {# C'est ici qu'il faut mettre la boucle pour parcourir tous les comptes bancaires #}
                {% set x = 0 %}
                {% for compteBancaire in facture.compteBancaires %}
                    {% if (x % 2) == 0 %}
                        <tr class="texte-centre bg-pair">
                        {% else %}
                        <tr class="texte-centre">
                    {% endif %}
                            <td class = "tableau-bordure-blanche">{{ compteBancaire.intitule}}</td>
                            <td class = "tableau-bordure-blanche">{{ compteBancaire.numero}}</td>
                            <td class = "tableau-bordure-blanche">{{ compteBancaire.banque}}</td>
                            <td class = "tableau-bordure-blanche">{{ compteBancaire.codeSwift}}</td>
                            <td class = "tableau-bordure-blanche">{{ compteBancaire.codeMonnaie}}</td>
                        </tr>
                    {% set x = x + 1 %}
                {% endfor %}
            </table>
            {# Nom de la société et autres informations de pieds de page #}
            <table class="tableau-bordure-top largeur-max">
                <tr>
                    <td class="texte-centre">
                        <span class="texte-gras">{{facture.entreprise.nom}}</span><br>
                        {{facture.entreprise.adresse}} | Tél: {{facture.entreprise.telephone}}<br>
                        RCCM: {{facture.entreprise.rccm}} | ID.NAT: {{facture.entreprise.idnat}} | NUM. IMPOT: {{facture.entreprise.numimpot}}
                    </td>
                </tr>
                <tr>
                    <td class="texte-centre bordure-top">
                        Page 1/1
                    </td>
                </tr>
            </table>
        </div>
    </div>
    <div class="page">
        Page 2
    </div>
    <div class="page">
        Page 3
    </div>
    <div class="page">
        Page 4
    </div>
    <div class="page">
        Page 5
    </div>
</body>
</html>